<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TheKrochet | Future of Handmade</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">

<link rel="stylesheet" href="brand.css">
<link rel="stylesheet" href="responsive.css">

<style>
/* =========================================
   üé® PINTEREST / ART STYLE THEME
   ========================================= */
:root{
  --bg: #0f0f1a; /* Deep Dark Background for Neon Pop */
  --text: #ffffff;
  --card-bg: rgba(255, 255, 255, 0.03); /* Glass Effect */
  --glass-border: rgba(255, 255, 255, 0.1);
  --primary: #d4a373; 
  --neon-pink: #ff69b4;
  --neon-purple: #8a2be2;
  --shadow: rgba(0,0,0,0.5); 
  --ease: cubic-bezier(0.23, 1, 0.32, 1);
}

/* Light Mode Override */
body.light {
  --bg: #faf7f2; --text: #2f2f2f; 
  --card-bg: #ffffff; --glass-border: rgba(0,0,0,0.05);
  --shadow: rgba(0,0,0,0.08);
}

*{ margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
html { overflow-x: hidden; scroll-behavior: smooth; }

body{
  font-family:'Poppins',sans-serif; background:var(--bg); color:var(--text);
  min-height:100vh; display:flex; flex-direction:column;
  transition: background 0.5s var(--ease), color 0.5s var(--ease);
}

/* =========================================
   NAVIGATION (Glassmorphism)
   ========================================= */
nav {
  position: sticky; top: 0; z-index: 100;
  background: rgba(15, 15, 26, 0.7); backdrop-filter: blur(15px);
  padding: 15px 0; border-bottom: 1px solid var(--glass-border);
  transition: 0.3s;
}
body.light nav { background: rgba(255, 255, 255, 0.8); }

.nav-container { 
  display: flex; justify-content: space-between; align-items: center; 
  max-width: 1200px; margin: auto; padding: 0 20px;
}

.nav-logo { 
  font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 700; 
  color: var(--text); text-decoration: none; 
}
.nav-logo span { color: var(--neon-pink); }

.nav-links { display: flex; gap: 25px; }
.nav-links a { 
  text-decoration: none; color: var(--text); font-weight: 500; font-size: 0.95rem; 
  opacity: 0.8; transition: 0.3s; position: relative;
}
.nav-links a:hover, .nav-links a.active { opacity: 1; color: var(--neon-pink); }

.nav-icons { display: flex; gap: 15px; align-items: center; }
.icon-btn { cursor: pointer; font-size: 1.2rem; transition: 0.3s; position: relative; }
.icon-btn:hover { color: var(--neon-purple); transform: scale(1.1); }

/* =========================================
   ‚ú® NEW HERO SECTION (Split & Floating)
   ========================================= */
header.hero-split {
  display: flex; align-items: center; justify-content: space-between;
  min-height: 90vh; max-width: 1200px; margin: auto; padding: 20px;
  position: relative; overflow: hidden;
}

.hero-text { flex: 1; z-index: 2; }

.hero-text h1 {
  font-family: 'Playfair Display', serif; font-size: 4.5rem; line-height: 1.1;
  margin-bottom: 20px; letter-spacing: -1px;
}
.hero-text h1 span { 
  background: linear-gradient(to right, var(--neon-pink), var(--neon-purple));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

.hero-text p { font-size: 1.1rem; opacity: 0.8; margin-bottom: 30px; max-width: 500px; }

.hero-visual { flex: 1; display: flex; justify-content: center; position: relative; }

/* The Floating Animation */
@keyframes float {
  0% { transform: translateY(0px) rotate(0deg); }
  50% { transform: translateY(-20px) rotate(2deg); }
  100% { transform: translateY(0px) rotate(0deg); }
}

.hero-img-main {
  width: 100%; max-width: 450px; border-radius: 30px;
  animation: float 6s ease-in-out infinite;
  box-shadow: 0 20px 50px rgba(138, 43, 226, 0.3); /* Purple Glow */
  filter: brightness(1.1);
}

.btn-primary {
  padding: 12px 30px; border-radius: 50px; border: none;
  background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
  color: white; font-weight: 600; font-size: 1rem; cursor: pointer;
  box-shadow: 0 10px 20px rgba(255, 105, 180, 0.3);
  transition: transform 0.3s; text-decoration: none; display: inline-block;
}
.btn-primary:hover { transform: translateY(-3px) scale(1.05); }

/* =========================================
   üñºÔ∏è ART CARD PRODUCTS (Pinterest Style)
   ========================================= */
section { padding: 60px 20px; max-width: 1300px; margin: auto; }
.section-title { font-family: 'Playfair Display', serif; font-size: 2.5rem; margin-bottom: 40px; text-align: center; }

.grid-art { 
  display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
  gap: 30px; 
}

.art-card {
  background: var(--card-bg);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  overflow: hidden;
  transition: transform 0.4s ease, box-shadow 0.4s ease;
  position: relative;
  /* Make card tall like a poster */
  display: flex; flex-direction: column;
}

.art-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  border-color: var(--neon-purple);
}

.art-img-box {
  width: 100%; height: 350px; /* Tall Images */
  overflow: hidden; cursor: pointer; position: relative;
}

.art-img-box img {
  width: 100%; height: 100%; object-fit: cover;
  transition: transform 0.6s ease;
}
.art-card:hover .art-img-box img { transform: scale(1.1); }

.art-details { padding: 20px; position: relative; }
.art-details h3 { font-size: 1.3rem; margin-bottom: 5px; font-weight: 600; }
.art-details .price { color: var(--neon-pink); font-size: 1.1rem; font-weight: 700; }

.btn-add {
  width: 100%; margin-top: 15px; padding: 10px; border: 1px solid var(--glass-border);
  background: rgba(255,255,255,0.05); color: var(--text); border-radius: 10px;
  cursor: pointer; transition: 0.3s;
}
.btn-add:hover { background: var(--text); color: var(--bg); }

/* =========================================
   UTILITIES & MODALS
   ========================================= */
.search-bar {
  width: 100%; max-width: 600px; margin: 0 auto 50px; display: block;
  padding: 15px 25px; border-radius: 50px; border: 1px solid var(--glass-border);
  background: var(--card-bg); color: var(--text); outline: none;
  font-size: 1rem; transition: 0.3s;
}
.search-bar:focus { border-color: var(--neon-pink); box-shadow: 0 0 15px rgba(255,105,180,0.2); }

/* Cart Float */
.cart-float { 
  position: fixed; right: 30px; bottom: 30px; 
  background: var(--neon-purple); color: #fff; width: 60px; height: 60px;
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  cursor: pointer; z-index: 999; box-shadow: 0 10px 30px rgba(138,43,226,0.4);
  font-size: 1.5rem; transition: transform 0.3s;
}
.cart-float:hover { transform: scale(1.1) rotate(10deg); }
#cartCount { font-size: 0.8rem; position: absolute; top: 0; right: 0; background: red; padding: 2px 6px; border-radius: 10px; }

/* Modal Styles (Kept consistent but dark themed) */
.modal { 
  display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
  background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); z-index: 1000;
  align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s;
}
.modal.show { display: flex; opacity: 1; }
.modal-box { 
  background: #1a1a2e; padding: 30px; border-radius: 20px; width: 90%; max-width: 500px; 
  border: 1px solid var(--glass-border); position: relative; color: white;
}
body.light .modal-box { background: #fff; color: #333; }
input, textarea { 
  width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; 
  border: 1px solid #444; background: #222; color: white; 
}
body.light input, body.light textarea { background: #f5f5f5; border: 1px solid #ddd; color: #333; }

/* Pay Grid */
.pay-apps-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
.pay-app-btn {
  background: white; padding: 15px; border-radius: 15px; cursor: pointer;
  display: flex; flex-direction: column; align-items: center; gap: 5px;
  color: black; font-weight: 600; font-size: 0.8rem; transition: 0.2s;
}
.pay-app-btn:hover { transform: scale(1.05); }
.pay-app-img { height: 30px; object-fit: contain; }

/* Mobile Responsiveness */
@media (max-width: 768px) {
  header.hero-split { flex-direction: column-reverse; text-align: center; justify-content: center; padding-top: 100px; }
  .hero-text h1 { font-size: 3rem; }
  .hero-img-main { max-width: 80%; margin-bottom: 30px; }
  .nav-links { display: none; } /* Use simple mobile nav if needed */
}
</style>
</head>

<body class="dark"> <nav>
  <div class="nav-container">
    <a href="#" class="nav-logo">The<span>Krochet</span></a>
    
    <div class="nav-links">
      <a href="#" class="active">Home</a>
      <a href="#shopSection">Collections</a>
      <a href="reviews.html">Reviews</a>
    </div>

    <div class="nav-icons">
      <div class="icon-btn theme-toggle" onclick="toggleTheme()">‚òÄÔ∏è</div>
      <div class="icon-btn" onclick="handleProfileClick()">üë§</div>
    </div>
  </div>
</nav>

<header class="hero-split">
  <div class="hero-text" data-aos="fade-right">
    <h1>Handmade <br> <span class="neon-text">Future Artifacts</span></h1>
    <p>Where traditional craftsmanship meets neon aesthetics. Custom crochet wearables and decor for the modern soul.</p>
    <a href="#shopSection" class="btn-primary">Explore Collection</a>
    <a href="https://www.instagram.com/thekrochet_" style="margin-left:15px; color:var(--text); text-decoration:none;">
      <i class="fab fa-instagram"></i> Instagram
    </a>
  </div>
  
  <div class="hero-visual" data-aos="fade-left">
    <img src="https://images.unsplash.com/photo-1619250907577-d51515286664?q=80&w=600&auto=format&fit=crop" 
         alt="Hero Crochet" 
         class="hero-img-main">
  </div>
</header>

<section id="shopSection">
  <h2 class="section-title" data-aos="fade-up">Curated Pieces</h2>
  
  <input type="text" id="searchInput" class="search-bar" placeholder="Search for wearables, decor..." data-aos="fade-up">

  <div id="products" class="grid-art">
    </div>
</section>

<div id="cartFloat" class="cart-float" onclick="openCart()">
  üõí <span id="cartCount">0</span>
</div>

<div id="cartModal" class="modal">
  <div class="modal-box">
    <h3>Your Cart</h3>
    <div id="cartItems" style="max-height:300px; overflow-y:auto; margin:15px 0;"></div>
    <div style="text-align:right; font-weight:bold; font-size:1.2rem; color:var(--neon-pink);">Total: ‚Çπ<span id="totalPrice">0</span></div>
    <div style="display:flex; gap:10px; margin-top:20px;">
      <button style="flex:1; padding:12px; background:grey; border:none; border-radius:10px; color:white;" onclick="closeModal('cartModal')">Close</button>
      <button style="flex:1; padding:12px; background:var(--neon-purple); border:none; border-radius:10px; color:white;" onclick="checkLoginForOrder()">Checkout</button>
    </div>
  </div>
</div>

<div id="orderModal" class="modal">
  <div class="modal-box">
    <h3>Shipping Details</h3>
    <input id="custName" placeholder="Full Name">
    <input id="custInsta" placeholder="Instagram (@username)">
    <textarea id="custAddress" rows="3" placeholder="Full Address (Street, City, Pin)"></textarea>
    <div style="display:flex; gap:10px; margin-top:20px;">
      <button style="flex:1; padding:12px; background:grey; border-radius:10px; border:none; color:white;" onclick="closeModal('orderModal')">Back</button>
      <button style="flex:1; padding:12px; background:var(--neon-pink); border-radius:10px; border:none; color:white;" onclick="openPaymentModal()">Pay Now</button>
    </div>
  </div>
</div>

<div id="paymentAppModal" class="modal">
  <div class="modal-box">
    <h3>Select Payment</h3>
    <p style="text-align:center; margin-bottom:15px;">Amount: ‚Çπ<span id="payAmountDisplay">0</span></p>
    <div class="pay-apps-grid">
      <div class="pay-app-btn" onclick="launchUPI('gpay')">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/Google_Pay_Logo.svg/512px-Google_Pay_Logo.svg.png" class="pay-app-img">
        <span>GPay</span>
      </div>
      <div class="pay-app-btn" onclick="launchUPI('paytm')">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Paytm_Logo_%28standalone%29.svg/512px-Paytm_Logo_%28standalone%29.svg.png" class="pay-app-img">
        <span>Paytm</span>
      </div>
      <div class="pay-app-btn" onclick="launchUPI('phonepe')">
        <img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/phonepe-logo-icon.png" class="pay-app-img">
        <span>PhonePe</span>
      </div>
      <div class="pay-app-btn" onclick="showQR()">
        <img src="https://cdn-icons-png.flaticon.com/512/3502/3502601.png" class="pay-app-img">
        <span>Scan QR</span>
      </div>
    </div>
    <button style="width:100%; margin-top:15px; background:transparent; border:none; color:white; cursor:pointer;" onclick="closeModal('paymentAppModal')">Cancel</button>
  </div>
</div>

<div id="qrModal" class="modal">
  <div class="modal-box" style="text-align:center;">
    <h3>Scan to Pay</h3>
    <img id="dynamicQR" style="width:200px; border-radius:10px; margin:15px 0;" src="" alt="Loading...">
    <div style="font-weight:bold; font-size:1.2rem; color:var(--neon-pink);">‚Çπ<span id="qrAmount">0</span></div>
    <button class="btn-primary" style="margin-top:15px; width:100%;" onclick="confirmAndFinishOrder()">I have Paid</button>
    <button style="width:100%; margin-top:10px; background:transparent; border:none; color:white; cursor:pointer;" onclick="closeModal('qrModal')">Close</button>
  </div>
</div>

<div id="orderSuccessModal" class="modal">
  <div class="modal-box" style="text-align:center;">
    <h1 style="font-size:3rem;">üéâ</h1>
    <h3 style="color:#00ff00;">Order Placed!</h3>
    <p>Thank you for shopping with TheKrochet.</p>
    <button class="btn-primary" style="margin-top:20px;" onclick="finishOrderFlow()">Continue</button>
  </div>
</div>

<div id="imgModal" class="modal" onclick="closeImg(event)">
    <div class="modal-box" id="imgBox" style="background:transparent; border:none; padding:0; box-shadow:none;"></div>
</div>

<footer>
    <div style="text-align:center; padding:20px; opacity:0.6;">¬© 2025 TheKrochet</div>
</footer>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>

<script>
/* üöÄ INIT ANIMATIONS */
AOS.init({ duration: 800, once: false });

/* THEME TOGGLE */
function toggleTheme(){
    const body = document.body;
    body.classList.toggle('light');
    body.classList.toggle('dark');
}

/* FIREBASE CONFIG */
const myUPI = "6351294436@ptaxis"; 
const myName = "TheKrochet";
firebase.initializeApp({
  apiKey:"AIzaSyAbFV0WbIVMpibxnIiVbwtnOqtvJ6ts_sY",
  authDomain:"thekrochet-b3ca2.firebaseapp.com",
  projectId:"thekrochet-b3ca2"
});
const db = firebase.firestore();
const auth = firebase.auth();

let cart = JSON.parse(localStorage.getItem("krochetCart")) || [];
let currentTotal = 0;

/* üé® LOAD PRODUCTS AS ART CARDS */
const productsDiv = document.getElementById("products");

db.collection("products").orderBy("createdAt","desc").onSnapshot(snap=>{
  let htmlString = "";
  
  snap.forEach((doc, idx)=>{
    const p=doc.data();
    let imgs = p.images || (p.image && p.image.includes(",") ? p.image.split(",").map(u=>u.trim()) : [p.image]);
    
    // ART CARD HTML STRUCTURE
    htmlString += `
      <div class="art-card" data-aos="fade-up" data-aos-delay="${idx * 50}">
        <div class="art-img-box" onclick='openImg(${JSON.stringify(imgs)})'>
            <img src="${imgs[0]}" alt="${p.name}">
        </div>
        <div class="art-details">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3>${p.name}</h3>
                <span class="price">‚Çπ${p.price}</span>
            </div>
            <button class="btn-add" onclick="addToCart('${p.name}',${p.price})">Add to Cart</button>
        </div>
      </div>`;
  });

  productsDiv.innerHTML = htmlString;
  setTimeout(() => AOS.refresh(), 200);
});

/* SEARCH */
document.getElementById("searchInput").addEventListener("input",(e)=>{ 
    const v=e.target.value.toLowerCase(); 
    document.querySelectorAll(".art-card").forEach(c=>{ 
        c.style.display = c.innerText.toLowerCase().includes(v) ? "flex" : "none"; 
    }); 
});

/* CART LOGIC */
function addToCart(name,price){ 
    cart.push({name,price}); 
    localStorage.setItem("krochetCart",JSON.stringify(cart)); 
    const floatBtn = document.getElementById("cartFloat");
    floatBtn.style.transform = "scale(1.3)";
    setTimeout(()=> floatBtn.style.transform = "scale(1)", 200);
    updateCartUI(); 
}

function updateCartUI(){ 
    const items=document.getElementById("cartItems"); 
    items.innerHTML=""; 
    currentTotal=0; 
    cart.forEach((p,i)=>{ 
        currentTotal+=p.price; 
        items.innerHTML+=`
        <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
            <span>${p.name}</span>
            <span>‚Çπ${p.price} <b style="color:red;margin-left:10px;cursor:pointer" onclick="removeItem(${i})">‚úï</b></span>
        </div>`; 
    }); 
    document.getElementById("cartCount").innerText=cart.length; 
    document.getElementById("totalPrice").innerText=currentTotal; 
    document.getElementById("payAmountDisplay").innerText=currentTotal;
}

function removeItem(i){ cart.splice(i,1); localStorage.setItem("krochetCart",JSON.stringify(cart)); updateCartUI(); }

/* MODAL HELPERS */
function openModal(id){ 
    document.getElementById(id).classList.add('show'); 
    document.getElementById(id).style.display = "flex";
}
function closeModal(id){ 
    document.getElementById(id).classList.remove('show'); 
    setTimeout(()=>document.getElementById(id).style.display="none", 300);
}

/* CHECKOUT FLOW */
function checkLoginForOrder(){ 
    closeModal('cartModal'); 
    if(auth.currentUser) { 
        // Auto-fill address if available (Assuming logic from profile.js)
        openModal('orderModal'); 
    } else { 
        alert("Please Login First (Profile Icon)"); 
        // Trigger profile login logic here if integrated
    } 
}

function openPaymentModal(){ 
    const name=document.getElementById("custName").value.trim(); 
    const addr=document.getElementById("custAddress").value.trim(); 
    if(!name || !addr) return alert("Details Required!");
    closeModal('orderModal'); 
    openModal('paymentAppModal'); 
}

function launchUPI(app){
    let link = `upi://pay?pa=${myUPI}&pn=${myName}&am=${currentTotal}&cu=INR`;
    if(app === 'paytm') link = `paytmmp://pay?pa=${myUPI}&pn=${myName}&am=${currentTotal}&cu=INR`;
    if(app === 'phonepe') link = `phonepe://pay?pa=${myUPI}&pn=${myName}&am=${currentTotal}&cu=INR`;
    
    window.location.href = link;
    // Simulate verification check
    setTimeout(()=> {
       if(confirm("Did you complete the payment in the app?")) confirmAndFinishOrder();
    }, 3000);
}

function showQR(){
    closeModal('paymentAppModal');
    const upiUrl = `upi://pay?pa=${myUPI}&pn=${myName}&am=${currentTotal}&cu=INR`;
    document.getElementById("dynamicQR").src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(upiUrl)}`;
    document.getElementById("qrAmount").innerText = currentTotal;
    openModal('qrModal');
}

function confirmAndFinishOrder(){
    const name = document.getElementById("custName").value;
    const addr = document.getElementById("custAddress").value;
    const insta = document.getElementById("custInsta").value;

    db.collection("orders").add({
        customerName: name, address: addr, instagram: insta,
        items: cart, total: currentTotal, status: "Paid/Pending",
        userId: auth.currentUser ? auth.currentUser.uid : 'guest',
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    }).then(() => {
        closeModal('qrModal');
        closeModal('paymentAppModal');
        openModal('orderSuccessModal');
    });
}

function finishOrderFlow(){
    cart = []; localStorage.removeItem("krochetCart");
    closeModal('orderSuccessModal');
    window.location.reload();
}

/* IMAGE POPUP LOGIC */
function openImg(imgs){
    const box = document.getElementById("imgBox");
    if(imgs.length === 1) {
        box.innerHTML = `<img src="${imgs[0]}" style="width:100%; border-radius:10px;">`;
    } else {
        // Simple slider logic for popup
        box.innerHTML = `<img src="${imgs[0]}" style="width:100%; border-radius:10px;">`;
    }
    openModal('imgModal');
}
function closeImg(e){ if(e.target.id === 'imgModal') closeModal('imgModal'); }

/* Initial Load */
updateCartUI();
</script>

<script src="profile.js"></script>
</body>
</html>

